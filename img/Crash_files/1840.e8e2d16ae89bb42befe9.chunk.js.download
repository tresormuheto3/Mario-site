(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[1840],{3154:function(e,t,i){},3872:function(e,t,i){"use strict";var n=i(3154);i.n(n).a},4293:function(e,t,i){"use strict";i.r(t);var n=i(0),r=i.n(n);function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var c=i(1),u=i(51);function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function d(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var l={name:"GamesProjectFrame",props:{url:{type:String,required:!0},isGamePage:{type:Boolean,required:!0}},data:function(){return{iframeElementHeight:0,isResizeEventTriggered:!1,deviceWidth:globalThis.innerWidth,iframePageLoaded:!1,bridge:null}},computed:d(d({},Object(u.mapGetters)("gamesProjectStore",["token","activeAccountId"])),{},{iframeElementStyle:function(){return{height:"".concat(this.iframeElementHeight,"px")}}}),watch:{token:function(e){this.sendSetUser(e)},activeAccountId:function(e){e&&this.sendSetActiveUserAccount(e)}},mounted:function(){var e,t,i,n,r=this;this.bridge=(e=this.$refs.iframeElement,t={},{setSupportedMethods:i=function(t){var i;null==e||null===(i=e.contentWindow)||void 0===i||i.postMessage({type:"SetSupportedMethods",data:t},"*")},send:n=function(t,i){var n;null==e||null===(n=e.contentWindow)||void 0===n||n.postMessage({type:t,data:i},"*")},subscribe:function(e,i){t[e]=i},unsubscribe:function(e){delete t[e]},listen:function(e){var r=e.data.channel;if("GPWebAppBridge"===(void 0===r?"":r)){var o=e.data,c=o.type,u=o.data,a=t[c];if(a&&"function"==typeof a){if("GPWebAppInit"===c){var d=Object.keys(t);i(d)}if(!u.requestId)return void a(u);a(u,(function(e){n("".concat(c,"Result"),s({requestId:u.requestId},e))}),(function(e){n("".concat(c,"Failed"),s({requestId:u.requestId},e))}))}}}}),globalThis.addEventListener("message",this.bridge.listen,!1),this.bridge.subscribe("GPWebAppInit",(function(e,t){setTimeout((function(){r.iframePageLoaded=!0,globalThis.addEventListener("resize",r.handleResize,!1)}),0),t({result:!0})})),this.bridge.subscribe("GPWebAppSetRoute",(function(e,t){r.emitSetRoute(e),t({result:!0})})),this.bridge.subscribe("GPWebAppSetPageTitle",(function(e,t){r.emitSetPageTitle(e),t({result:!0})})),this.bridge.subscribe("GPWebAppSetPageLoaded",(function(e,t){window.hideGlobalPreloader(),r.isResizeEventTriggered=!0,r.frameHeightUpdated(),r.emitSetScrollTop(),r.bridge.unsubscribe("GPWebAppSetPageLoaded"),t({result:!0})})),this.bridge.subscribe("GPWebAppShowAuthenticationRequired",(function(e,t){r.emitShowAuthenticationRequired(),t({result:!0})})),this.bridge.subscribe("GPWebAppShowAuthenticationFailed",(function(e,t){r.handleShowAuthenticationFailed().then((function(e){var i=e.token;t({token:i,result:!0})})).catch((function(){t({result:!0})}))})),this.bridge.subscribe("GPWebAppSetUserAccountBalance",(function(e,t){r.emitSetUserAccountBalance(e),t({result:!0})})),this.bridge.subscribe("GPWebAppSetViewportAttributes",(function(e,t){r.emitSetViewportAttributes(e),t({result:!0})})),this.bridge.subscribe("GPWebAppSetScrollState",(function(e,t){r.emitSetScrollState(e),t({result:!0})})),this.bridge.subscribe("GPWebAppGetPageAttributes",(function(e,t){r.bridge.send("GPWebAppSetPageAttributes",{scrollX:document.documentElement.scrollLeft,scrollY:document.documentElement.scrollTop,clientHeight:document.documentElement.clientHeight,clientWidth:document.documentElement.clientWidth}),t({result:!0})})),this.bridge.subscribe("GPWebRefreshPage",(function(e,t){window.location.reload(),t({result:!0})})),this.bridge.subscribe("GPWebAppSetIframeHeight",(function(e,t){var i=e.height;e.isResized?r.iframeElementHeight===i?r.frameHeightUpdated():0!==i||c.a.config.is_mobile?r.updateCurrentDeviceHeight():r.frameHeightUpdated():c.a.config.is_mobile||0!==i?r.iframeElementHeight=i:r.frameHeightUpdated(),t({result:!0})})),this.$nextTick((function(){r.updateCurrentDeviceHeight()}))},destroyed:function(){globalThis.removeEventListener("message",this.bridge.listen,!1)},methods:{emitSetRoute:function(e){this.$emit("setRoute",d({},e))},emitSetPageTitle:function(e){this.$emit("setPageTitle",d({},e))},emitShowAuthenticationRequired:function(e){this.$emit("showAuthenticationRequired",d({},e))},emitShowAuthenticationFailed:function(e){this.$emit("showAuthenticationFailed",d({},e))},emitSetUserAccountBalance:function(e){this.$emit("setUserAccountBalance",d({},e))},emitSetViewportAttributes:function(e){this.$emit("setViewportAttributes",d({},e))},emitSetScrollState:function(e){this.$emit("setScrollState",d({},e))},emitSetScrollTop:function(){this.$emit("setScrollTop")},handleShowAuthenticationFailed:function(){var e=this;return new Promise((function(t,i){e.emitShowAuthenticationFailed({resolve:t,reject:i})}))},frameHeightUpdated:function(){this.bridge.send("GPWebAppSetDocumentHeight",{height:this.iframeElementHeight,isResizeEventTriggered:this.isResizeEventTriggered,headerHeight:0,clientWidth:document.documentElement.clientWidth,clientHeight:document.documentElement.clientHeight}),this.isResizeEventTriggered=!1},updateCurrentDeviceHeight:function(){0!==globalThis.innerHeight&&(this.iframeElementHeight=globalThis.innerHeight)},handleResize:function(){c.a.config.is_mobile&&this.deviceWidth===globalThis.innerWidth||(this.isResizeEventTriggered=!0,this.deviceWidth=globalThis.innerWidth,this.updateCurrentDeviceHeight())},sendSetUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.bridge.send("GPWebAppSetUser",{token:e})},sendSetActiveUserAccount:function(e){this.bridge.send("GPWebAppSetActiveUserAccount",{accountId:e})}}},h=(i(3872),i(26)),b=Object(h.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"games-project-frame"},[i("iframe",{key:e.url,ref:"iframeElement",staticClass:"games-project-frame__item",class:{"games-project-frame__item--hidden":!e.iframePageLoaded},style:e.iframeElementStyle,attrs:{scrolling:"no",src:e.url},on:{transitionend:e.frameHeightUpdated}})])}),[],!1,null,"fda00b10",null);t.default=b.exports}}]);